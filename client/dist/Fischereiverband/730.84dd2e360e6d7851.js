"use strict";(self.webpackChunkFischereiverband=self.webpackChunkFischereiverband||[]).push([[730],{8730:(K,p,s)=>{s.r(p),s.d(p,{OwnerModule:()=>P});var l=s(6895),h=s(1760),m=s(6697),R=s(1634),r=s(4170),t=s(4650),f=s(6142);const C=["grid"];let S=(()=>{class i{constructor(){this.path="grids/owner",this.file="observation-sheet.json"}unsavedChanges(){return this.grid.unsavedChanges()}static#t=this.\u0275fac=function(n){return new(n||i)};static#e=this.\u0275cmp=t.Xpm({type:i,selectors:[["app-observation-sheet"]],viewQuery:function(n,o){if(1&n&&t.Gf(C,5),2&n){let a;t.iGM(a=t.CRH())&&(o.grid=a.first)}},decls:2,vars:2,consts:[[3,"path","file"],["grid",""]],template:function(n,o){1&n&&t._UZ(0,"app-dynamic-grid",0,1),2&n&&t.Q6J("path",o.path)("file",o.file)},dependencies:[f.d]})}return i})();var _=s(8541),g=s(3794),y=s(9992),k=s(8283),M=s(5696),d=s(4006),x=s(392),F=s(8012),b=s(3382),u=s(3662),v=s(7296);const A=["grid"],T=["dialogConfirm"],Z=["dialogRequestForAdditionalChanges"];function Q(i,c){if(1&i&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&i){const e=c.item;t.xp6(1),t.AsE("",e.fbz," - ",e.year,"")}}function J(i,c){if(1&i&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&i){const e=c.item;t.xp6(1),t.AsE("",e.fbz," - ",e.year,"")}}function w(i,c){if(1&i&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&i){const e=c.item;t.xp6(1),t.AsE("",e.fbz," - ",e.year,"")}}function I(i,c){if(1&i&&(t.TgZ(0,"div")(1,"ngb-alert",16)(2,"div",17),t._uU(3),t.ALo(4,"translate"),t.ALo(5,"date"),t.qZA()()()),2&i){const e=t.oxw(3);t.xp6(1),t.Q6J("type","success")("dismissible",!1),t.xp6(2),t.AsE("",t.lcZ(4,4,"actionMessage.reportCompleted")," ",t.xi3(5,6,e.fishStockingReport.date_completed,"dd.MM.yyyy. HH:mm"),"")}}function N(i,c){1&i&&(t.TgZ(0,"div")(1,"ngb-alert",16)(2,"div",17),t._uU(3),t.ALo(4,"translate"),t.qZA()()()),2&i&&(t.xp6(1),t.Q6J("type","warning")("dismissible",!1),t.xp6(2),t.Oqu(t.lcZ(4,3,"actionMessage.reportCompletedNotYet")))}function z(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"button",18),t.NdJ("click",function(){t.CHM(e);const o=t.oxw(3);return t.KtG(o.completeReports())}),t._UZ(1,"span",19),t._uU(2),t.ALo(3,"translate"),t.qZA()}2&i&&(t.xp6(2),t.hij(" ",t.lcZ(3,1,"action.completeReport"),""))}function G(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"button",20),t.NdJ("click",function(){t.CHM(e);const o=t.oxw(3);return t.KtG(o.requestForAdditionalChanges())}),t._UZ(1,"span",21),t._uU(2),t.ALo(3,"translate"),t.qZA()}2&i&&(t.xp6(2),t.hij(" ",t.lcZ(3,1,"action.requestAdminToChangeStatus"),""))}function L(i,c){if(1&i&&(t.TgZ(0,"div",11)(1,"div",4)(2,"div",12),t.YNc(3,I,6,9,"div",0),t.YNc(4,N,5,5,"div",0),t.qZA(),t.TgZ(5,"div",13),t.YNc(6,z,4,3,"button",14),t.YNc(7,G,4,3,"button",15),t.qZA()()()),2&i){const e=t.oxw(2);t.xp6(3),t.Q6J("ngIf",e.fishStockingReport&&e.fishStockingReport.status===e.fishStockingReportEnum.completed),t.xp6(1),t.Q6J("ngIf",e.data&&e.data.length&&(!e.fishStockingReport||e.fishStockingReport.status===e.fishStockingReportEnum.draft)),t.xp6(2),t.Q6J("ngIf",e.data&&e.data.length&&(!e.fishStockingReport||e.fishStockingReport.status===e.fishStockingReportEnum.draft)),t.xp6(1),t.Q6J("ngIf",e.fishStockingReport&&e.fishStockingReport.status===e.fishStockingReportEnum.completed)}}function Y(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"app-dynamic-grid",23,24),t.NdJ("submit",function(o){t.CHM(e);const a=t.oxw(3);return t.KtG(a.submit(o))})("refreshParentComponent",function(){t.CHM(e);const o=t.oxw(3);return t.KtG(o.refreshGrid())}),t.qZA()}if(2&i){const e=t.oxw(3);t.Q6J("path",e.path)("file",e.file)("data",e.data)("additionalData",e.selectedRegistry)("disableCRUD",e.fishStockingReport&&e.fishStockingReport.status===e.fishStockingReportEnum.completed)}}function D(i,c){if(1&i&&(t.TgZ(0,"div"),t.YNc(1,Y,2,5,"app-dynamic-grid",22),t.qZA()),2&i){const e=t.oxw(2);t.xp6(1),t.Q6J("ngIf",!e.loading)}}function U(i,c){1&i&&t._UZ(0,"app-no-data")}function E(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"div")(1,"div",4)(2,"div",5)(3,"ng-select",6),t.NdJ("ngModelChange",function(o){t.CHM(e);const a=t.oxw();return t.KtG(a.selectedManagementRegistryId=o)})("change",function(o){t.CHM(e);const a=t.oxw();return t.KtG(a.onChange(o))}),t.YNc(4,Q,2,2,"ng-template",7),t.YNc(5,J,2,2,"ng-template",8),t.YNc(6,w,2,2,"ng-template",9),t.qZA()(),t.YNc(7,L,8,4,"div",10),t.qZA(),t.YNc(8,D,2,1,"div",0),t.YNc(9,U,1,0,"app-no-data",0),t.qZA()}if(2&i){const e=t.oxw();t.xp6(3),t.Q6J("items",e.managementRegistersData)("ngModel",e.selectedManagementRegistryId)("searchable",!0),t.xp6(4),t.Q6J("ngIf",e.selectedManagementRegistryId),t.xp6(1),t.Q6J("ngIf",e.selectedManagementRegistry),t.xp6(1),t.Q6J("ngIf",!e.managementRegistersData||!e.managementRegistersData.length||!e.selectedManagementRegistry)}}function H(i,c){1&i&&t._UZ(0,"app-loader")}let q=(()=>{class i{constructor(e,n,o){this._service=e,this._toastr=n,this._storageService=o,this.path="grids/owner",this.file="fish-stocking.json",this.fishStockingReport=new _.V,this.loading=!1,this.fishStockingReportEnum=g.o}unsavedChanges(){if(this.grid)return this.grid.unsavedChanges()}ngOnInit(){this._service.callGetMethod("/api/owner/getFbzRegister","").subscribe(e=>{this.managementRegistersData=e,e.length&&(this.selectedManagementRegistry=this._storageService.getLocalStorage("selectedManagementRegistry")?this._storageService.getLocalStorage("selectedManagementRegistry"):e[0],this.selectedManagementRegistryId=this.selectedManagementRegistry.id,this.initializeFishStocking())})}initializeFishStocking(){this.getFishStockingReport(),this.getAllFishStocking()}getFishStockingReport(){this._service.callGetMethod("/api/owner/getFishStockingReport?fbz="+this.selectedManagementRegistry.fbz).subscribe(e=>{this.fishStockingReport=e?e[0]:new _.V})}getAllFishStocking(){this.loading=!0,this._service.callGetMethod("/api/owner/getAllFishStocking?fbz="+this.selectedManagementRegistry.fbz+"&year="+this.selectedManagementRegistry.year,"").subscribe(e=>{this.data=e,this.loading=!1})}checkCompletedStatusReport(){return this.fishStockingReport&&this.fishStockingReport.status===g.o.completed}onChange(e){this.selectedManagementRegistry=e,this.selectedManagementRegistry?(this.selectedManagementRegistryId=e.id,this._storageService.setLocalStorage("selectedManagementRegistry",this.selectedManagementRegistry),this.initializeFishStocking()):(this._storageService.removeLocalStorage("selectedManagementRegistry"),this.selectedManagementRegistryId=null)}submit(e){e.fbz=this.selectedManagementRegistry.fbz,e.year=this.selectedManagementRegistry.year,this._service.callPostMethod("/api/owner/setFishStocking",e).subscribe(n=>{n&&(this.getAllFishStocking(),this._toastr.showSuccess())})}refreshGrid(){this.getAllFishStocking()}completeReports(){this.dialogConfirm.showQuestionModal()}requestForAdditionalChanges(){this.dialogRequestForAdditionalChanges.showQuestionModal()}confirmCompleteReport(){this.fishStockingReport={fbz:this.selectedManagementRegistry.fbz,year:this.selectedManagementRegistry.year,status:g.o.completed,date_completed:new Date},this._service.callPostMethod("/api/owner/completeReport",this.fishStockingReport).subscribe(e=>{e&&(this.getAllFishStocking(),this._toastr.showSuccess())})}requestToAdminForAdditionalChanges(){this._service.callPostMethod("/api/owner/requestToAdminForAdditionalChanges",this.fishStockingReport).subscribe(e=>{e&&(this.getAllFishStocking(),this._toastr.showSuccess())})}static#t=this.\u0275fac=function(n){return new(n||i)(t.Y36(y.f),t.Y36(k.l),t.Y36(M.V))};static#e=this.\u0275cmp=t.Xpm({type:i,selectors:[["app-fish-stocking"]],viewQuery:function(n,o){if(1&n&&(t.Gf(A,5),t.Gf(T,5),t.Gf(Z,5)),2&n){let a;t.iGM(a=t.CRH())&&(o.grid=a.first),t.iGM(a=t.CRH())&&(o.dialogConfirm=a.first),t.iGM(a=t.CRH())&&(o.dialogRequestForAdditionalChanges=a.first)}},decls:14,vars:26,consts:[[4,"ngIf"],[3,"title","content","confirmButtonText","cancelButtonText","confirm"],["dialogConfirm",""],["dialogRequestForAdditionalChanges",""],[1,"row"],[1,"mb-2","col-lg-3","col-md-12"],["bindLabel","fbz","bindValue","id",3,"items","ngModel","searchable","ngModelChange","change"],["ng-label-tmp",""],["ng-value-tmp",""],["ng-option-tmp",""],["class","col-lg-9",4,"ngIf"],[1,"col-lg-9"],[1,"col-lg-9","col-md-8","text-center"],[1,"col-lg-3","col-md-4","text-right"],["class","btn btn-success full-width",3,"click",4,"ngIf"],["class","btn btn-danger full-width",3,"click",4,"ngIf"],[3,"type","dismissible"],[1,"alert-body"],[1,"btn","btn-success","full-width",3,"click"],[1,"fa","fa-check"],[1,"btn","btn-danger","full-width",3,"click"],[1,"fa","fa-question-circle-o"],[3,"path","file","data","additionalData","disableCRUD","submit","refreshParentComponent",4,"ngIf"],[3,"path","file","data","additionalData","disableCRUD","submit","refreshParentComponent"],["grid",""]],template:function(n,o){1&n&&(t.YNc(0,E,10,6,"div",0),t.YNc(1,H,1,0,"app-loader",0),t.TgZ(2,"app-dialog-confirm",1,2),t.NdJ("confirm",function(){return o.confirmCompleteReport()}),t.ALo(4,"translate"),t.ALo(5,"translate"),t.ALo(6,"translate"),t.ALo(7,"translate"),t.qZA(),t.TgZ(8,"app-dialog-confirm",1,3),t.NdJ("confirm",function(){return o.requestToAdminForAdditionalChanges()}),t.ALo(10,"translate"),t.ALo(11,"translate"),t.ALo(12,"translate"),t.ALo(13,"translate"),t.qZA()),2&n&&(t.Q6J("ngIf",o.managementRegistersData),t.xp6(1),t.Q6J("ngIf",o.loading),t.xp6(1),t.Q6J("title",t.lcZ(4,10,"actionMessage.dialogCompleteReportQuestionTitle"))("content",t.lcZ(5,12,"actionMessage.dialogCompleteReportQuestionText"))("confirmButtonText",t.lcZ(6,14,"actionMessage.dialogCompleteReportQuestionYes"))("cancelButtonText",t.lcZ(7,16,"actionMessage.dialogCompleteReportQuestionNo")),t.xp6(6),t.Q6J("title",t.lcZ(10,18,"actionMessage.dialogRequestForAdditionalChangesTitle"))("content",t.lcZ(11,20,"actionMessage.dialogRequestForAdditionalChangesText"))("confirmButtonText",t.lcZ(12,22,"generalDialog.yes"))("cancelButtonText",t.lcZ(13,24,"generalDialog.no")))},dependencies:[l.O5,d.JJ,d.On,f.d,r.w9,r.Z2,r.bb,x.p,F.R,b.d,u.xm,l.uU,v.X$]})}return i})();var B=s(3735);const O=[{path:"fish-stocking",component:q,canDeactivate:[m.T]},{path:"observation-sheet",component:S,canDeactivate:[m.T]}];let P=(()=>{class i{static#t=this.\u0275fac=function(n){return new(n||i)};static#e=this.\u0275mod=t.oAB({type:i});static#i=this.\u0275inj=t.cJS({imports:[l.ez,d.u5,h.Bz.forChild(O),R.w,r.A0,B.$,v.aw,u._A,h.Bz]})}return i})()}}]);