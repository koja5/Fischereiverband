"use strict";(self.webpackChunkFischereiverband=self.webpackChunkFischereiverband||[]).push([[457],{457:(xe,F,s)=>{s.r(F),s.d(F,{OwnerModule:()=>Ce});var c=s(6895),T=s(1760),Z=s(677),N=s(1977),l=s(4170),t=s(4650),_=s(6142);const D=["grid"];let E=(()=>{class n{constructor(){this.path="grids/owner",this.file="observation-sheet.json"}unsavedChanges(){return this.grid.unsavedChanges()}static#t=this.\u0275fac=function(i){return new(i||n)};static#e=this.\u0275cmp=t.Xpm({type:n,selectors:[["app-observation-sheet"]],viewQuery:function(i,a){if(1&i&&t.Gf(D,5),2&i){let o;t.iGM(o=t.CRH())&&(a.grid=o.first)}},decls:2,vars:2,consts:[[3,"path","file"],["grid",""]],template:function(i,a){1&i&&t._UZ(0,"app-dynamic-grid",0,1),2&i&&t.Q6J("path",a.path)("file",a.file)},dependencies:[_.d]})}return n})();var P=s(8541),p=s(3794),h=s(9992),f=s(8283),u=s(5696),g=s(4006),b=s(392),C=s(8012),J=s(3382),d=s(3662),m=s(7296);const B=["grid"],Q=["dialogConfirm"],G=["dialogRequestForAdditionalChanges"],H=["dialogNoHaveEntry"];function q(n,r){if(1&n&&(t.TgZ(0,"div")(1,"ngb-alert",13)(2,"div",14),t._uU(3),t.ALo(4,"translate"),t.ALo(5,"date"),t.qZA()()()),2&n){const e=t.oxw(2);t.xp6(1),t.Q6J("type","success")("dismissible",!1),t.xp6(2),t.AsE("",t.lcZ(4,4,"actionMessage.reportCompleted")," ",t.xi3(5,6,e.fishStockingReport.date_completed,"dd.MM.yyyy. HH:mm"),"")}}function L(n,r){1&n&&(t.TgZ(0,"div")(1,"ngb-alert",13)(2,"div",14),t._uU(3),t.ALo(4,"translate"),t.qZA()()()),2&n&&(t.xp6(1),t.Q6J("type","warning")("dismissible",!1),t.xp6(2),t.Oqu(t.lcZ(4,3,"actionMessage.reportCompletedNotYet")))}function z(n,r){if(1&n&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&n){const e=r.item;t.xp6(1),t.AsE("",e.fbz," - ",e.year,"")}}function I(n,r){if(1&n&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&n){const e=r.item;t.xp6(1),t.AsE("",e.fbz," - ",e.year,"")}}function Y(n,r){if(1&n&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&n){const e=r.item;t.xp6(1),t.AsE("",e.fbz," - ",e.year,"")}}function U(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"button",20),t.NdJ("click",function(){t.CHM(e);const a=t.oxw(3);return t.KtG(a.completeReports())}),t._UZ(1,"span",21),t._uU(2),t.ALo(3,"translate"),t.qZA()}2&n&&(t.xp6(2),t.hij(" ",t.lcZ(3,1,"action.completeReport"),""))}function K(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"button",22),t.NdJ("click",function(){t.CHM(e);const a=t.oxw(3);return t.KtG(a.requestForAdditionalChanges())}),t._UZ(1,"span",23),t._uU(2),t.ALo(3,"translate"),t.qZA()}2&n&&(t.xp6(2),t.hij(" ",t.lcZ(3,1,"action.requestAdminToChangeStatus"),""))}function W(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"button",24),t.NdJ("click",function(){t.CHM(e);const a=t.oxw(3);return t.KtG(a.noHaveFishStockingEntryDialog())}),t._UZ(1,"span",25),t._uU(2),t.ALo(3,"translate"),t.qZA()}2&n&&(t.xp6(2),t.hij(" ",t.lcZ(3,1,"action.noHaveEntry"),""))}function V(n,r){if(1&n&&(t.TgZ(0,"div",15)(1,"div",16),t.YNc(2,U,4,3,"button",17),t.YNc(3,K,4,3,"button",18),t.YNc(4,W,4,3,"button",19),t.qZA()()),2&n){const e=t.oxw(2);t.xp6(2),t.Q6J("ngIf",e.data&&e.data.length&&(!e.fishStockingReport||e.fishStockingReport.status===e.fishStockingReportEnum.draft)),t.xp6(1),t.Q6J("ngIf",e.fishStockingReport&&e.fishStockingReport.status===e.fishStockingReportEnum.completed),t.xp6(1),t.Q6J("ngIf",!e.fishStockingReport||e.fishStockingReport.status!==e.fishStockingReportEnum.completed)}}function j(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"app-dynamic-grid",27,28),t.NdJ("submit",function(a){t.CHM(e);const o=t.oxw(3);return t.KtG(o.submit(a))})("refreshParentComponent",function(){t.CHM(e);const a=t.oxw(3);return t.KtG(a.refreshGrid())}),t.qZA()}if(2&n){const e=t.oxw(3);t.Q6J("path",e.path)("file",e.file)("data",e.data)("additionalData",e.selectedRegistry)("disableCRUD",e.fishStockingReport&&e.fishStockingReport.status===e.fishStockingReportEnum.completed)}}function X(n,r){if(1&n&&(t.TgZ(0,"div"),t.YNc(1,j,2,5,"app-dynamic-grid",26),t.qZA()),2&n){const e=t.oxw(2);t.xp6(1),t.Q6J("ngIf",!e.loading)}}function $(n,r){1&n&&t._UZ(0,"app-no-data")}function tt(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"div")(1,"div",5)(2,"div",6),t.YNc(3,q,6,9,"div",0),t.YNc(4,L,5,5,"div",0),t.qZA(),t.TgZ(5,"div",7)(6,"ng-select",8),t.NdJ("ngModelChange",function(a){t.CHM(e);const o=t.oxw();return t.KtG(o.selectedManagementRegistryId=a)})("change",function(a){t.CHM(e);const o=t.oxw();return t.KtG(o.onChange(a))}),t.ALo(7,"translate"),t.YNc(8,z,2,2,"ng-template",9),t.YNc(9,I,2,2,"ng-template",10),t.YNc(10,Y,2,2,"ng-template",11),t.qZA()(),t.YNc(11,V,5,3,"div",12),t.qZA(),t.YNc(12,X,2,1,"div",0),t.YNc(13,$,1,0,"app-no-data",0),t.qZA()}if(2&n){const e=t.oxw();t.xp6(3),t.Q6J("ngIf",e.fishStockingReport&&e.fishStockingReport.status===e.fishStockingReportEnum.completed),t.xp6(1),t.Q6J("ngIf",e.data&&e.data.length&&(!e.fishStockingReport||e.fishStockingReport.status===e.fishStockingReportEnum.draft)),t.xp6(2),t.Q6J("items",e.managementRegistersData)("ngModel",e.selectedManagementRegistryId)("placeholder",t.lcZ(7,9,"commonFields.chooseManagementRegistry"))("searchable",!0),t.xp6(5),t.Q6J("ngIf",e.selectedManagementRegistryId&&!e.loading),t.xp6(1),t.Q6J("ngIf",e.selectedManagementRegistry),t.xp6(1),t.Q6J("ngIf",!e.managementRegistersData||!e.managementRegistersData.length||!e.selectedManagementRegistry)}}function et(n,r){1&n&&t._UZ(0,"app-loader")}let nt=(()=>{class n{constructor(e,i,a){this._service=e,this._toastr=i,this._storageService=a,this.path="grids/owner",this.file="fish-stocking.json",this.fishStockingReport=new P.V,this.loading=!0,this.fishStockingReportEnum=p.o}unsavedChanges(){if(this.grid)return this.grid.unsavedChanges()}ngOnInit(){this._service.callGetMethod("/api/owner/getManagementRegistersData","").subscribe(e=>{this.managementRegistersData=e,e.length&&(this.selectedManagementRegistry=this._storageService.getLocalStorage("selectedManagementRegistry")?this._storageService.getLocalStorage("selectedManagementRegistry"):e[0],this.selectedManagementRegistryId=this.selectedManagementRegistry.id,this.initializeFishStocking())})}initializeFishStocking(){this.getFishStockingReport(),this.getAllFishStocking()}getFishStockingReport(){this._service.callGetMethod("/api/owner/getFishStockingReport?fbz="+this.selectedManagementRegistry.fbz).subscribe(e=>{this.fishStockingReport=e?e[0]:new P.V})}getAllFishStocking(){this.loading=!0,this._service.callGetMethod("/api/owner/getAllFishStocking?fbz="+this.selectedManagementRegistry.fbz+"&year="+this.selectedManagementRegistry.year,"").subscribe(e=>{this.data=e,this.loading=!1})}checkCompletedStatusReport(){return this.fishStockingReport&&this.fishStockingReport.status===p.o.completed}onChange(e){this.selectedManagementRegistry=e,this.selectedManagementRegistry?(this.selectedManagementRegistryId=e.id,this._storageService.setLocalStorage("selectedManagementRegistry",this.selectedManagementRegistry),this.initializeFishStocking()):(this._storageService.removeLocalStorage("selectedManagementRegistry"),this.selectedManagementRegistryId=null)}submit(e){e.fbz=this.selectedManagementRegistry.fbz,e.year=this.selectedManagementRegistry.year,this._service.callPostMethod("/api/owner/setFishStocking",e).subscribe(i=>{i&&(this.getAllFishStocking(),this._toastr.showSuccess())})}refreshGrid(){this.getAllFishStocking()}completeReports(){this.dialogConfirm.showQuestionModal()}requestForAdditionalChanges(){this.dialogRequestForAdditionalChanges.showQuestionModal()}confirmCompleteReport(){this.fishStockingReport={fbz:this.selectedManagementRegistry.fbz,year:this.selectedManagementRegistry.year,status:p.o.completed,date_completed:new Date},this._service.callPostMethod("/api/owner/completeFishStockingReport",this.fishStockingReport).subscribe(e=>{e&&(this.getAllFishStocking(),this._toastr.showSuccess())})}requestToAdminForAdditionalChanges(){this._service.callPostMethod("/api/owner/requestToAdminForAdditionalFishStockingReportChanges",this.fishStockingReport).subscribe(e=>{e&&(this.getAllFishStocking(),this._toastr.showSuccess())})}noHaveFishStockingEntryDialog(){this.dialogNoHaveEntry.showQuestionModal()}confirmNoHaveFishStockingEntry(){this.loading=!0,this.fishStockingReport={fbz:this.selectedManagementRegistry.fbz,year:this.selectedManagementRegistry.year,status:p.o.completed,date_completed:new Date},this._service.callPostMethod("/api/owner/noHaveFishStockingEntry",this.fishStockingReport).subscribe(e=>{e&&(this.refreshGrid(),this._toastr.showSuccess())})}static#t=this.\u0275fac=function(i){return new(i||n)(t.Y36(h.f),t.Y36(f.l),t.Y36(u.V))};static#e=this.\u0275cmp=t.Xpm({type:n,selectors:[["app-fish-stocking"]],viewQuery:function(i,a){if(1&i&&(t.Gf(B,5),t.Gf(Q,5),t.Gf(G,5),t.Gf(H,5)),2&i){let o;t.iGM(o=t.CRH())&&(a.grid=o.first),t.iGM(o=t.CRH())&&(a.dialogConfirm=o.first),t.iGM(o=t.CRH())&&(a.dialogRequestForAdditionalChanges=o.first),t.iGM(o=t.CRH())&&(a.dialogNoHaveEntry=o.first)}},decls:20,vars:38,consts:[[4,"ngIf"],[3,"title","content","confirmButtonText","cancelButtonText","confirm"],["dialogConfirm",""],["dialogNoHaveEntry",""],["dialogRequestForAdditionalChanges",""],[1,"row"],[1,"col-md-12","text-center"],[1,"mb-2","col-md-3"],["bindLabel","fbz","bindValue","id",3,"items","ngModel","placeholder","searchable","ngModelChange","change"],["ng-label-tmp",""],["ng-value-tmp",""],["ng-option-tmp",""],["class","col-md-9",4,"ngIf"],[3,"type","dismissible"],[1,"alert-body"],[1,"col-md-9"],[1,"d-flex","justify-content-end","action"],["class","btn btn-success mb-1",3,"click",4,"ngIf"],["class","btn btn-primary mb-1",3,"click",4,"ngIf"],["class","btn btn-outline-danger mb-1 ml-1",3,"click",4,"ngIf"],[1,"btn","btn-success","mb-1",3,"click"],[1,"fa","fa-check"],[1,"btn","btn-primary","mb-1",3,"click"],[1,"fa","fa-question-circle-o"],[1,"btn","btn-outline-danger","mb-1","ml-1",3,"click"],[1,"fa","fa-times"],[3,"path","file","data","additionalData","disableCRUD","submit","refreshParentComponent",4,"ngIf"],[3,"path","file","data","additionalData","disableCRUD","submit","refreshParentComponent"],["grid",""]],template:function(i,a){1&i&&(t.YNc(0,tt,14,11,"div",0),t.YNc(1,et,1,0,"app-loader",0),t.TgZ(2,"app-dialog-confirm",1,2),t.NdJ("confirm",function(){return a.confirmCompleteReport()}),t.ALo(4,"translate"),t.ALo(5,"translate"),t.ALo(6,"translate"),t.ALo(7,"translate"),t.qZA(),t.TgZ(8,"app-dialog-confirm",1,3),t.NdJ("confirm",function(){return a.confirmNoHaveFishStockingEntry()}),t.ALo(10,"translate"),t.ALo(11,"translate"),t.ALo(12,"translate"),t.ALo(13,"translate"),t.qZA(),t.TgZ(14,"app-dialog-confirm",1,4),t.NdJ("confirm",function(){return a.requestToAdminForAdditionalChanges()}),t.ALo(16,"translate"),t.ALo(17,"translate"),t.ALo(18,"translate"),t.ALo(19,"translate"),t.qZA()),2&i&&(t.Q6J("ngIf",a.managementRegistersData),t.xp6(1),t.Q6J("ngIf",a.loading),t.xp6(1),t.Q6J("title",t.lcZ(4,14,"actionMessage.dialogCompleteReportQuestionTitle"))("content",t.lcZ(5,16,"actionMessage.dialogCompleteReportQuestionText"))("confirmButtonText",t.lcZ(6,18,"actionMessage.dialogCompleteReportQuestionYes"))("cancelButtonText",t.lcZ(7,20,"actionMessage.dialogCompleteReportQuestionNo")),t.xp6(6),t.Q6J("title",t.lcZ(10,22,"actionMessage.dialogNoHaveReportsTitle"))("content",t.lcZ(11,24,"actionMessage.dialogNoHaveReportsText"))("confirmButtonText",t.lcZ(12,26,"generalDialog.yes"))("cancelButtonText",t.lcZ(13,28,"generalDialog.no")),t.xp6(6),t.Q6J("title",t.lcZ(16,30,"actionMessage.dialogRequestForAdditionalChangesTitle"))("content",t.lcZ(17,32,"actionMessage.dialogRequestForAdditionalChangesText"))("confirmButtonText",t.lcZ(18,34,"generalDialog.yes"))("cancelButtonText",t.lcZ(19,36,"generalDialog.no")))},dependencies:[c.O5,g.JJ,g.On,_.d,l.w9,l.Z2,l.bb,b.p,C.R,J.d,d.xm,c.uU,m.X$],styles:['.ngx-datatable.material[_ngcontent-%COMP%]{background:#fff;box-shadow:0 5px 5px -3px #0003,0 8px 10px 1px #00000024,0 3px 14px 2px #0000001f}.ngx-datatable.material.striped[_ngcontent-%COMP%]   .datatable-row-odd[_ngcontent-%COMP%]{background:#eee}.ngx-datatable.material.single-selection[_ngcontent-%COMP%]   .datatable-body-row.active[_ngcontent-%COMP%], .ngx-datatable.material.single-selection[_ngcontent-%COMP%]   .datatable-body-row.active[_ngcontent-%COMP%]   .datatable-row-group[_ngcontent-%COMP%], .ngx-datatable.material.multi-selection[_ngcontent-%COMP%]   .datatable-body-row.active[_ngcontent-%COMP%], .ngx-datatable.material.multi-selection[_ngcontent-%COMP%]   .datatable-body-row.active[_ngcontent-%COMP%]   .datatable-row-group[_ngcontent-%COMP%], .ngx-datatable.material.multi-click-selection[_ngcontent-%COMP%]   .datatable-body-row.active[_ngcontent-%COMP%], .ngx-datatable.material.multi-click-selection[_ngcontent-%COMP%]   .datatable-body-row.active[_ngcontent-%COMP%]   .datatable-row-group[_ngcontent-%COMP%]{background-color:#304ffe;color:#fff}.ngx-datatable.material.single-selection[_ngcontent-%COMP%]   .datatable-body-row.active[_ngcontent-%COMP%]:hover, .ngx-datatable.material.single-selection[_ngcontent-%COMP%]   .datatable-body-row.active[_ngcontent-%COMP%]:hover   .datatable-row-group[_ngcontent-%COMP%], .ngx-datatable.material.multi-selection[_ngcontent-%COMP%]   .datatable-body-row.active[_ngcontent-%COMP%]:hover, .ngx-datatable.material.multi-selection[_ngcontent-%COMP%]   .datatable-body-row.active[_ngcontent-%COMP%]:hover   .datatable-row-group[_ngcontent-%COMP%], .ngx-datatable.material.multi-click-selection[_ngcontent-%COMP%]   .datatable-body-row.active[_ngcontent-%COMP%]:hover, .ngx-datatable.material.multi-click-selection[_ngcontent-%COMP%]   .datatable-body-row.active[_ngcontent-%COMP%]:hover   .datatable-row-group[_ngcontent-%COMP%]{background-color:#193ae4;color:#fff}.ngx-datatable.material.single-selection[_ngcontent-%COMP%]   .datatable-body-row.active[_ngcontent-%COMP%]:focus, .ngx-datatable.material.single-selection[_ngcontent-%COMP%]   .datatable-body-row.active[_ngcontent-%COMP%]:focus   .datatable-row-group[_ngcontent-%COMP%], .ngx-datatable.material.multi-selection[_ngcontent-%COMP%]   .datatable-body-row.active[_ngcontent-%COMP%]:focus, .ngx-datatable.material.multi-selection[_ngcontent-%COMP%]   .datatable-body-row.active[_ngcontent-%COMP%]:focus   .datatable-row-group[_ngcontent-%COMP%], .ngx-datatable.material.multi-click-selection[_ngcontent-%COMP%]   .datatable-body-row.active[_ngcontent-%COMP%]:focus, .ngx-datatable.material.multi-click-selection[_ngcontent-%COMP%]   .datatable-body-row.active[_ngcontent-%COMP%]:focus   .datatable-row-group[_ngcontent-%COMP%]{background-color:#2041ef;color:#fff}.ngx-datatable.material[_ngcontent-%COMP%]:not(.cell-selection)   .datatable-body-row[_ngcontent-%COMP%]:hover, .ngx-datatable.material[_ngcontent-%COMP%]:not(.cell-selection)   .datatable-body-row[_ngcontent-%COMP%]:hover   .datatable-row-group[_ngcontent-%COMP%]{background-color:#eee;transition-property:background;transition-duration:.3s;transition-timing-function:linear}.ngx-datatable.material[_ngcontent-%COMP%]:not(.cell-selection)   .datatable-body-row[_ngcontent-%COMP%]:focus, .ngx-datatable.material[_ngcontent-%COMP%]:not(.cell-selection)   .datatable-body-row[_ngcontent-%COMP%]:focus   .datatable-row-group[_ngcontent-%COMP%]{background-color:#ddd}.ngx-datatable.material.cell-selection[_ngcontent-%COMP%]   .datatable-body-cell[_ngcontent-%COMP%]:hover, .ngx-datatable.material.cell-selection[_ngcontent-%COMP%]   .datatable-body-cell[_ngcontent-%COMP%]:hover   .datatable-row-group[_ngcontent-%COMP%]{background-color:#eee;transition-property:background;transition-duration:.3s;transition-timing-function:linear}.ngx-datatable.material.cell-selection[_ngcontent-%COMP%]   .datatable-body-cell[_ngcontent-%COMP%]:focus, .ngx-datatable.material.cell-selection[_ngcontent-%COMP%]   .datatable-body-cell[_ngcontent-%COMP%]:focus   .datatable-row-group[_ngcontent-%COMP%]{background-color:#ddd}.ngx-datatable.material.cell-selection[_ngcontent-%COMP%]   .datatable-body-cell.active[_ngcontent-%COMP%], .ngx-datatable.material.cell-selection[_ngcontent-%COMP%]   .datatable-body-cell.active[_ngcontent-%COMP%]   .datatable-row-group[_ngcontent-%COMP%]{background-color:#304ffe;color:#fff}.ngx-datatable.material.cell-selection[_ngcontent-%COMP%]   .datatable-body-cell.active[_ngcontent-%COMP%]:hover, .ngx-datatable.material.cell-selection[_ngcontent-%COMP%]   .datatable-body-cell.active[_ngcontent-%COMP%]:hover   .datatable-row-group[_ngcontent-%COMP%]{background-color:#193ae4;color:#fff}.ngx-datatable.material.cell-selection[_ngcontent-%COMP%]   .datatable-body-cell.active[_ngcontent-%COMP%]:focus, .ngx-datatable.material.cell-selection[_ngcontent-%COMP%]   .datatable-body-cell.active[_ngcontent-%COMP%]:focus   .datatable-row-group[_ngcontent-%COMP%]{background-color:#2041ef;color:#fff}.ngx-datatable.material[_ngcontent-%COMP%]   .empty-row[_ngcontent-%COMP%]{height:50px;text-align:left;padding:.5rem 1.2rem;vertical-align:top;border-top:0}.ngx-datatable.material[_ngcontent-%COMP%]   .loading-row[_ngcontent-%COMP%]{text-align:left;padding:.5rem 1.2rem;vertical-align:top;border-top:0}.ngx-datatable.material[_ngcontent-%COMP%]   .datatable-header[_ngcontent-%COMP%]   .datatable-row-left[_ngcontent-%COMP%], .ngx-datatable.material[_ngcontent-%COMP%]   .datatable-body[_ngcontent-%COMP%]   .datatable-row-left[_ngcontent-%COMP%]{background-color:#fff;background-position:100% 0;background-repeat:repeat-y;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAABCAYAAAD5PA/NAAAAFklEQVQIHWPSkNeSBmJhTQVtbiDNCgASagIIuJX8OgAAAABJRU5ErkJggg==)}.ngx-datatable.material[_ngcontent-%COMP%]   .datatable-header[_ngcontent-%COMP%]   .datatable-row-right[_ngcontent-%COMP%], .ngx-datatable.material[_ngcontent-%COMP%]   .datatable-body[_ngcontent-%COMP%]   .datatable-row-right[_ngcontent-%COMP%]{background-position:0 0;background-color:#fff;background-repeat:repeat-y;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAABCAYAAAD5PA/NAAAAFklEQVQI12PQkNdi1VTQ5gbSwkAsDQARLAIGtOSFUAAAAABJRU5ErkJggg==)}.ngx-datatable.material[_ngcontent-%COMP%]   .datatable-header[_ngcontent-%COMP%]{border-bottom:1px solid rgba(0,0,0,.12)}.ngx-datatable.material[_ngcontent-%COMP%]   .datatable-header[_ngcontent-%COMP%]   .datatable-header-cell[_ngcontent-%COMP%]{text-align:left;padding:.9rem 1.2rem;font-weight:400;background-color:#fff;color:#0000008a;vertical-align:bottom;font-size:12px;font-weight:500}.ngx-datatable.material[_ngcontent-%COMP%]   .datatable-header[_ngcontent-%COMP%]   .datatable-header-cell[_ngcontent-%COMP%]   .datatable-header-cell-wrapper[_ngcontent-%COMP%]{position:relative}.ngx-datatable.material[_ngcontent-%COMP%]   .datatable-header[_ngcontent-%COMP%]   .datatable-header-cell.longpress[_ngcontent-%COMP%]   .draggable[_ngcontent-%COMP%]:after{transition:transform .4s ease,opacity .4s ease;opacity:.5;transform:scale(1)}.ngx-datatable.material[_ngcontent-%COMP%]   .datatable-header[_ngcontent-%COMP%]   .datatable-header-cell[_ngcontent-%COMP%]   .draggable[_ngcontent-%COMP%]:after{content:" ";position:absolute;top:50%;left:50%;margin:-30px 0 0 -30px;height:60px;width:60px;background:#eee;border-radius:100%;opacity:1;filter:none;transform:scale(0);z-index:9999;pointer-events:none}.ngx-datatable.material[_ngcontent-%COMP%]   .datatable-header[_ngcontent-%COMP%]   .datatable-header-cell.dragging[_ngcontent-%COMP%]   .resize-handle[_ngcontent-%COMP%]{border-right:none}.ngx-datatable.material[_ngcontent-%COMP%]   .datatable-header[_ngcontent-%COMP%]   .resize-handle[_ngcontent-%COMP%]{border-right:solid 1px #eee}.ngx-datatable.material[_ngcontent-%COMP%]   .datatable-body[_ngcontent-%COMP%]{position:relative}.ngx-datatable.material[_ngcontent-%COMP%]   .datatable-body[_ngcontent-%COMP%]   .datatable-row-detail[_ngcontent-%COMP%]{background:#f5f5f5;padding:10px}.ngx-datatable.material[_ngcontent-%COMP%]   .datatable-body[_ngcontent-%COMP%]   .datatable-group-header[_ngcontent-%COMP%]{background:#f5f5f5;border-bottom:solid 1px #d9d8d9;border-top:solid 1px #d9d8d9}.ngx-datatable.material[_ngcontent-%COMP%]   .datatable-body[_ngcontent-%COMP%]   .datatable-body-row[_ngcontent-%COMP%]   .datatable-body-cell[_ngcontent-%COMP%], .ngx-datatable.material[_ngcontent-%COMP%]   .datatable-body[_ngcontent-%COMP%]   .datatable-body-row[_ngcontent-%COMP%]   .datatable-body-group-cell[_ngcontent-%COMP%]{text-align:left;padding:.9rem 1.2rem;vertical-align:top;border-top:0;color:#000000de;transition:width .3s ease;font-size:14px;font-weight:400}.ngx-datatable.material[_ngcontent-%COMP%]   .datatable-body[_ngcontent-%COMP%]   .progress-linear[_ngcontent-%COMP%]{display:block;position:sticky;width:100%;height:5px;padding:0;margin:0;top:0}.ngx-datatable.material[_ngcontent-%COMP%]   .datatable-body[_ngcontent-%COMP%]   .progress-linear[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]{display:block;position:relative;overflow:hidden;width:100%;height:5px;transform:translate(0) scale(1);background-color:#aad1f9}.ngx-datatable.material[_ngcontent-%COMP%]   .datatable-body[_ngcontent-%COMP%]   .progress-linear[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .bar[_ngcontent-%COMP%]{transition:all .2s linear;animation:_ngcontent-%COMP%_query .8s infinite cubic-bezier(.39,.575,.565,1);transition:transform .2s linear;background-color:#106cc8;position:absolute;left:0;top:0;bottom:0;width:100%;height:5px}.ngx-datatable.material[_ngcontent-%COMP%]   .datatable-footer[_ngcontent-%COMP%]{border-top:1px solid rgba(0,0,0,.12);font-size:12px;font-weight:400;color:#0000008a}.ngx-datatable.material[_ngcontent-%COMP%]   .datatable-footer[_ngcontent-%COMP%]   .page-count[_ngcontent-%COMP%]{line-height:50px;height:50px;padding:0 1.2rem}.ngx-datatable.material[_ngcontent-%COMP%]   .datatable-footer[_ngcontent-%COMP%]   .datatable-pager[_ngcontent-%COMP%]{margin:0 10px}.ngx-datatable.material[_ngcontent-%COMP%]   .datatable-footer[_ngcontent-%COMP%]   .datatable-pager[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{vertical-align:middle}.ngx-datatable.material[_ngcontent-%COMP%]   .datatable-footer[_ngcontent-%COMP%]   .datatable-pager[_ngcontent-%COMP%]   li.disabled[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#00000042!important;background-color:transparent!important}.ngx-datatable.material[_ngcontent-%COMP%]   .datatable-footer[_ngcontent-%COMP%]   .datatable-pager[_ngcontent-%COMP%]   li.active[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{background-color:#9e9e9e33;font-weight:700}.ngx-datatable.material[_ngcontent-%COMP%]   .datatable-footer[_ngcontent-%COMP%]   .datatable-pager[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{height:22px;min-width:24px;line-height:22px;padding:0 6px;border-radius:3px;margin:6px 3px;text-align:center;vertical-align:top;color:#0000008a;text-decoration:none;vertical-align:bottom}.ngx-datatable.material[_ngcontent-%COMP%]   .datatable-footer[_ngcontent-%COMP%]   .datatable-pager[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{color:#000000bf;background-color:#9e9e9e33}.ngx-datatable.material[_ngcontent-%COMP%]   .datatable-footer[_ngcontent-%COMP%]   .datatable-pager[_ngcontent-%COMP%]   .datatable-icon-left[_ngcontent-%COMP%], .ngx-datatable.material[_ngcontent-%COMP%]   .datatable-footer[_ngcontent-%COMP%]   .datatable-pager[_ngcontent-%COMP%]   .datatable-icon-skip[_ngcontent-%COMP%], .ngx-datatable.material[_ngcontent-%COMP%]   .datatable-footer[_ngcontent-%COMP%]   .datatable-pager[_ngcontent-%COMP%]   .datatable-icon-right[_ngcontent-%COMP%], .ngx-datatable.material[_ngcontent-%COMP%]   .datatable-footer[_ngcontent-%COMP%]   .datatable-pager[_ngcontent-%COMP%]   .datatable-icon-prev[_ngcontent-%COMP%]{font-size:20px;line-height:20px;padding:0 3px}.ngx-datatable.material[_ngcontent-%COMP%]   .datatable-summary-row[_ngcontent-%COMP%]   .datatable-body-row[_ngcontent-%COMP%], .ngx-datatable.material[_ngcontent-%COMP%]   .datatable-summary-row[_ngcontent-%COMP%]   .datatable-body-row[_ngcontent-%COMP%]:hover{background-color:#ddd}.ngx-datatable.material[_ngcontent-%COMP%]   .datatable-summary-row[_ngcontent-%COMP%]   .datatable-body-row[_ngcontent-%COMP%]   .datatable-body-cell[_ngcontent-%COMP%]{font-weight:700}.datatable-checkbox[_ngcontent-%COMP%]{position:relative;margin:0;cursor:pointer;vertical-align:middle;display:inline-block;box-sizing:border-box;padding:0}.datatable-checkbox[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]{position:relative;margin:0 1rem 0 0;cursor:pointer;outline:none}.datatable-checkbox[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:before{transition:all .3s ease-in-out;content:"";position:absolute;left:0;z-index:1;width:1rem;height:1rem;border:2px solid #f2f2f2}.datatable-checkbox[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:checked:before{transform:rotate(-45deg);height:.5rem;border-color:#009688;border-top-style:none;border-right-style:none}.datatable-checkbox[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:after{content:"";position:absolute;top:0;left:0;width:1rem;height:1rem;background:#fff;cursor:pointer}@keyframes _ngcontent-%COMP%_query{0%{opacity:1;transform:translate(35%) scaleX(.3)}to{opacity:0;transform:translate(-50%) scaleX(0)}}']})}return n})();var at=s(3735),v=s(8330),O=s(9308),M=s(9830);class S{}var k=s(9993),y=s(3283);const it=["grid"],ot=["dialogConfirm"],rt=["dialogRequestForAdditionalChanges"],st=["dialogNoHaveEntry"],lt=["modalNewEntrie"];function ct(n,r){if(1&n&&(t.TgZ(0,"div")(1,"ngb-alert",16)(2,"div",17),t._uU(3),t.ALo(4,"translate"),t.ALo(5,"date"),t.qZA()()()),2&n){const e=t.oxw(2);t.xp6(1),t.Q6J("type","success")("dismissible",!1),t.xp6(2),t.AsE("",t.lcZ(4,4,"actionMessage.reportCompleted")," ",t.xi3(5,6,e.fishCatchReport.date_completed,"dd.MM.yyyy. HH:mm"),"")}}function gt(n,r){1&n&&(t.TgZ(0,"div")(1,"ngb-alert",16)(2,"div",17),t._uU(3),t.ALo(4,"translate"),t.qZA()()()),2&n&&(t.xp6(1),t.Q6J("type","warning")("dismissible",!1),t.xp6(2),t.Oqu(t.lcZ(4,3,"actionMessage.reportCompletedNotYet")))}function dt(n,r){if(1&n&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&n){const e=r.item;t.xp6(1),t.AsE("",e.fbz," - ",e.year,"")}}function mt(n,r){if(1&n&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&n){const e=r.item;t.xp6(1),t.AsE("",e.fbz," - ",e.year,"")}}function _t(n,r){if(1&n&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&n){const e=r.item;t.xp6(1),t.AsE("",e.fbz," - ",e.year,"")}}function pt(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"p",18),t.NdJ("click",function(){t.CHM(e);const a=t.oxw(2);return t.KtG(a.openModalNewEntrie())}),t._UZ(1,"span",19),t._uU(2),t.ALo(3,"translate"),t.qZA()}2&n&&(t.xp6(2),t.hij(" ",t.lcZ(3,1,"commonFields.createNew")," "))}function ht(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"button",25),t.NdJ("click",function(){t.CHM(e);const a=t.oxw(3);return t.KtG(a.completeReportsDialog())}),t._UZ(1,"span",26),t._uU(2),t.ALo(3,"translate"),t.qZA()}2&n&&(t.xp6(2),t.hij(" ",t.lcZ(3,1,"action.completeReport"),""))}function ft(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"button",27),t.NdJ("click",function(){t.CHM(e);const a=t.oxw(3);return t.KtG(a.requestForAdditionalChanges())}),t._UZ(1,"span",28),t._uU(2),t.ALo(3,"translate"),t.qZA()}2&n&&(t.xp6(2),t.hij(" ",t.lcZ(3,1,"action.requestAdminToChangeStatus"),""))}function ut(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"button",29),t.NdJ("click",function(){t.CHM(e);const a=t.oxw(3);return t.KtG(a.noHaveFishCatchEntryDialog())}),t._UZ(1,"span",30),t._uU(2),t.ALo(3,"translate"),t.qZA()}2&n&&(t.xp6(2),t.hij(" ",t.lcZ(3,1,"action.noHaveEntry"),""))}function bt(n,r){if(1&n&&(t.TgZ(0,"div",20)(1,"div",21),t.YNc(2,ht,4,3,"button",22),t.YNc(3,ft,4,3,"button",23),t.YNc(4,ut,4,3,"button",24),t.qZA()()),2&n){const e=t.oxw(2);t.xp6(2),t.Q6J("ngIf",e.allData&&e.allData.length&&(!e.fishCatchReport||e.fishCatchReport.status===e.fishCatchReportEnum.draft)),t.xp6(1),t.Q6J("ngIf",e.fishCatchReport&&e.fishCatchReport.status===e.fishCatchReportEnum.completed),t.xp6(1),t.Q6J("ngIf",!e.fishCatchReport||e.fishCatchReport.status!==e.fishCatchReportEnum.completed)}}function Ct(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"div")(1,"app-dynamic-grid",31,32),t.NdJ("submit",function(a){t.CHM(e);const o=t.oxw(2);return t.KtG(o.submit(a))})("refreshParentComponent",function(){t.CHM(e);const a=t.oxw(2);return t.KtG(a.refreshGrid())}),t.qZA()()}if(2&n){const e=t.oxw(2);t.xp6(1),t.Q6J("path",e.path)("file",e.file)("data",e.data)("disableCRUD",!(e.fishCatchFilter&&e.fishCatchFilter.water)||e.fishCatchReport&&e.fishCatchReport.status===e.fishCatchReportEnum.completed)}}function Mt(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"div")(1,"div",6)(2,"div",7),t.YNc(3,ct,6,9,"div",0),t.YNc(4,gt,5,5,"div",0),t.qZA(),t.TgZ(5,"div",8)(6,"ng-select",9),t.NdJ("ngModelChange",function(a){t.CHM(e);const o=t.oxw();return t.KtG(o.fishCatchFilter.managementRegisterId=a)})("change",function(a){t.CHM(e);const o=t.oxw();return t.KtG(o.onChangeManagementRegister(a))}),t.ALo(7,"translate"),t.YNc(8,dt,2,2,"ng-template",10),t.YNc(9,mt,2,2,"ng-template",11),t.YNc(10,_t,2,2,"ng-template",12),t.qZA()(),t.TgZ(11,"div",8)(12,"ng-select",13),t.NdJ("ngModelChange",function(a){t.CHM(e);const o=t.oxw();return t.KtG(o.fishCatchFilter.water=a)})("change",function(a){t.CHM(e);const o=t.oxw();return t.KtG(o.onChangeWater(a))}),t.ALo(13,"translate"),t.YNc(14,pt,4,3,"ng-template",14),t.qZA()(),t.YNc(15,bt,5,3,"div",15),t.qZA(),t.YNc(16,Ct,3,4,"div",0),t.qZA()}if(2&n){const e=t.oxw();t.xp6(3),t.Q6J("ngIf",e.fishCatchReport&&e.fishCatchReport.status===e.fishCatchReportEnum.completed),t.xp6(1),t.Q6J("ngIf",e.allData&&e.allData.length&&(!e.fishCatchReport||e.fishCatchReport.status===e.fishCatchReportEnum.draft)),t.xp6(2),t.Q6J("items",e.managementRegistersData)("ngModel",e.fishCatchFilter.managementRegisterId)("placeholder",t.lcZ(7,12,"commonFields.chooseManagementRegistry"))("searchable",!0),t.xp6(6),t.Q6J("items",e.allWaters)("ngModel",e.fishCatchFilter.water)("placeholder",t.lcZ(13,14,"commonFields.chooseNameOfWater"))("searchable",!0),t.xp6(3),t.Q6J("ngIf",e.fishCatchFilter.managementRegister),t.xp6(1),t.Q6J("ngIf",!e.loading)}}function xt(n,r){1&n&&t._UZ(0,"app-loader")}function vt(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"div",33)(1,"h5",34),t._uU(2),t.ALo(3,"translate"),t.qZA(),t.TgZ(4,"button",35),t.NdJ("click",function(){const o=t.CHM(e).$implicit;return t.KtG(o.dismiss("Cross click"))}),t.TgZ(5,"span",36),t._uU(6,"\xd7"),t.qZA()()(),t.TgZ(7,"div",37)(8,"app-dynamic-forms",38,39),t.NdJ("submit",function(a){t.CHM(e);const o=t.oxw();return t.KtG(o.submitNewEntriesEmitter(a))}),t.qZA()()}if(2&n){const e=t.oxw();t.xp6(2),t.Oqu(e.title?e.title:t.lcZ(3,3,"generalDialog.areYouSure")),t.xp6(6),t.Q6J("path","forms/owner")("file","new-entrie-name-of-water.json")}}let yt=(()=>{class n{constructor(e,i,a,o,w,Me){this._service=e,this._toastr=i,this._storageService=a,this._translate=o,this._modalService=w,this._helpService=Me,this.path="grids/owner",this.file="fish-catch.json",this.fishCatchReport=new O.P,this.fishCatchFilter=new v.r,this.loading=!1,this.fishCatchReportEnum=M.e,this.waterCustom=new S}unsavedChanges(){if(this.grid)return this.grid.unsavedChanges()}ngOnInit(){this.initialize()}initialize(){this._storageService.getValueFromLocalStorage("fish-catch-filter")?(this.fishCatchFilter=this._storageService.getValueFromLocalStorage("fish-catch-filter"),this.getFishCatchDetailsForManagementRegister()):this.fishCatchFilter=new v.r,this._service.callGetMethod("/api/owner/getManagementRegistersData","").subscribe(e=>{this.managementRegistersData=e,e.length&&(this.fishCatchFilter.managementRegister?this.getWatersForSelectedManagementRegister(this.fishCatchFilter.managementRegister.fbz):this.data=[])})}getFishStockingReport(){this._service.callGetMethod("/api/owner/getFishCatchReport?fbz="+this.fishCatchFilter.managementRegister.fbz).subscribe(e=>{this.fishCatchReport=e?e[0]:new O.P})}getFishCatchDetailsForManagementRegister(){this._service.callGetMethod("/api/owner/getFishCatchDetailsForManagementRegister?fbz="+this.fishCatchFilter.managementRegister.fbz).subscribe(e=>{this.allData=e})}checkCompletedStatusReport(){return this.fishCatchReport&&this.fishCatchReport.status===M.e.completed}onChangeManagementRegister(e){this.fishCatchFilter.managementRegister=e,this.fishCatchFilter.water=null,this._storageService.setValueInLocalStorage("fish-catch-filter",this.fishCatchFilter),this.fishCatchFilter.managementRegister?(this.fishCatchFilter.managementRegisterId=e.id,this.getWatersForSelectedManagementRegister(e.fbz),this._storageService.setLocalStorage("selectedManagementRegistry",this.fishCatchFilter.managementRegister)):(this._storageService.deleteValueFromLocalStorage("fish-catch-filter"),this.fishCatchFilter=new v.r,this.refreshGrid())}getWatersForSelectedManagementRegister(e){this._service.callGetMethod("api/owner/getAllWaters?fbz="+e).subscribe(i=>{this.allWaters=i,1===i.length&&(this.fishCatchFilter.water=i[0].id),this.getFishStockingReport(),this.getFishCatchDetailsForSelectedWater()})}onChangeWater(){this.getFishCatchDetailsForSelectedWater(),this._storageService.setValueInLocalStorage("fish-catch-filter",this.fishCatchFilter)}getFishCatchDetailsForSelectedWater(){this.loading=!0,this.fishCatchFilter.managementRegister||this.fishCatchFilter.water?this._service.callGetMethod("api/owner/getFishCatchDetailsForSelectedWater?fbz="+this.fishCatchFilter.managementRegister.fbz+"&id_water="+this.fishCatchFilter.water).subscribe(e=>{this.data=e,this.loading=!1}):setTimeout(()=>{this.data=[],this.loading=!1},100)}submit(e){if(e.edible_fish_quantity<=e.quantity)e.stocked_fish_quantity=e.quantity-e.edible_fish_quantity;else if(e.edible_fish_quantity>e.quantity)return void this._toastr.showWarningCustom(this._translate.instant("actionMessage.successExecuteActionTextDefault"));e.fbz=this.fishCatchFilter.managementRegister.fbz,e.year=this.fishCatchFilter.managementRegister.year,e.id_water=this.fishCatchFilter.water,this.loading=!0,this._service.callPostMethod("/api/owner/setFishCatch",e).subscribe(i=>{i&&(this._toastr.showSuccess(),this.getFishCatchDetailsForSelectedWater(),this.getFishCatchDetailsForManagementRegister())})}refreshGrid(){this.getFishCatchDetailsForSelectedWater(),this.getFishCatchDetailsForManagementRegister()}completeReportsDialog(){this.dialogConfirm.showQuestionModal()}requestForAdditionalChanges(){this.dialogRequestForAdditionalChanges.showQuestionModal()}confirmCompleteReport(){this.loading=!0,this.fishCatchReport={fbz:this.fishCatchFilter.managementRegister.fbz,year:this.fishCatchFilter.managementRegister.year,status:M.e.completed,date_completed:new Date},this._service.callPostMethod("/api/owner/completeFishCatchReport",this.fishCatchReport).subscribe(e=>{e&&(this._toastr.showSuccess(),this.refreshGrid())})}requestToAdminForAdditionalChanges(){this._service.callPostMethod("/api/owner/requestToAdminForAdditionalFishCatchReportChanges",this.fishCatchReport).subscribe(e=>{e&&this._toastr.showSuccess()})}noHaveFishCatchEntryDialog(){this.dialogNoHaveEntry.showQuestionModal()}confirmNoHaveFishCatchEntry(){this.loading=!0,this.fishCatchReport={fbz:this.fishCatchFilter.managementRegister.fbz,year:this.fishCatchFilter.managementRegister.year,status:M.e.completed,date_completed:new Date},this._service.callPostMethod("/api/owner/noHaveFishCatchEntry",this.fishCatchReport).subscribe(e=>{e&&(this.refreshGrid(),this._toastr.showSuccess())})}openModalNewEntrie(){setTimeout(()=>{this.modalDialog=this._modalService.open(this.modal,{centered:!0,windowClass:"modal modal-danger"})},20)}submitNewEntriesEmitter(e){this._helpService.checkUndefinedProperty(e)&&"submit"!=e.type&&(this.waterCustom={type_of_water:e.type_of_water,name:e.name,fbz:this.fishCatchFilter.managementRegister.fbz},this._service.callPostMethod("/api/owner/createNewWaterNameEntry",this.waterCustom).subscribe(i=>{this.getWatersForSelectedManagementRegister(this.fishCatchFilter.managementRegister.fbz),this.fishCatchFilter.water=i}))}static#t=this.\u0275fac=function(i){return new(i||n)(t.Y36(h.f),t.Y36(f.l),t.Y36(u.V),t.Y36(m.sK),t.Y36(d.FF),t.Y36(k.s))};static#e=this.\u0275cmp=t.Xpm({type:n,selectors:[["app-fish-catch"]],viewQuery:function(i,a){if(1&i&&(t.Gf(it,5),t.Gf(ot,5),t.Gf(rt,5),t.Gf(st,5),t.Gf(lt,5)),2&i){let o;t.iGM(o=t.CRH())&&(a.grid=o.first),t.iGM(o=t.CRH())&&(a.dialogConfirm=o.first),t.iGM(o=t.CRH())&&(a.dialogRequestForAdditionalChanges=o.first),t.iGM(o=t.CRH())&&(a.dialogNoHaveEntry=o.first),t.iGM(o=t.CRH())&&(a.modal=o.first)}},decls:22,vars:38,consts:[[4,"ngIf"],["modalNewEntrie",""],[3,"title","content","confirmButtonText","cancelButtonText","confirm"],["dialogConfirm",""],["dialogNoHaveEntry",""],["dialogRequestForAdditionalChanges",""],[1,"row"],[1,"col-md-12","text-center"],[1,"mb-2","col-md-3"],["bindLabel","fbz","bindValue","id",3,"items","ngModel","placeholder","searchable","ngModelChange","change"],["ng-label-tmp",""],["ng-value-tmp",""],["ng-option-tmp",""],["bindLabel","name","bindValue","id",3,"items","ngModel","placeholder","searchable","ngModelChange","change"],["ng-footer-tmp",""],["class","col-md-6",4,"ngIf"],[3,"type","dismissible"],[1,"alert-body"],[1,"m-0","font-weight-bold","cursor-pointer",3,"click"],[1,"fa","fa-plus-circle"],[1,"col-md-6"],[1,"d-flex","justify-content-end","action"],["class","btn btn-success mb-1",3,"click",4,"ngIf"],["class","btn btn-primary mb-1",3,"click",4,"ngIf"],["class","btn btn-outline-danger mb-1 ml-1",3,"click",4,"ngIf"],[1,"btn","btn-success","mb-1",3,"click"],[1,"fa","fa-check"],[1,"btn","btn-primary","mb-1",3,"click"],[1,"fa","fa-question-circle-o"],[1,"btn","btn-outline-danger","mb-1","ml-1",3,"click"],[1,"fa","fa-times"],[3,"path","file","data","disableCRUD","submit","refreshParentComponent"],["grid",""],[1,"modal-header"],["id","myModalLabel160",1,"modal-title"],["type","button","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],["tabindex","0","ngbAutofocus","",1,"modal-body"],[3,"path","file","submit"],["form","dynamicForm"]],template:function(i,a){1&i&&(t.YNc(0,Mt,17,16,"div",0),t.YNc(1,xt,1,0,"app-loader",0),t.YNc(2,vt,10,5,"ng-template",null,1,t.W1O),t.TgZ(4,"app-dialog-confirm",2,3),t.NdJ("confirm",function(){return a.confirmCompleteReport()}),t.ALo(6,"translate"),t.ALo(7,"translate"),t.ALo(8,"translate"),t.ALo(9,"translate"),t.qZA(),t.TgZ(10,"app-dialog-confirm",2,4),t.NdJ("confirm",function(){return a.confirmNoHaveFishCatchEntry()}),t.ALo(12,"translate"),t.ALo(13,"translate"),t.ALo(14,"translate"),t.ALo(15,"translate"),t.qZA(),t.TgZ(16,"app-dialog-confirm",2,5),t.NdJ("confirm",function(){return a.requestToAdminForAdditionalChanges()}),t.ALo(18,"translate"),t.ALo(19,"translate"),t.ALo(20,"translate"),t.ALo(21,"translate"),t.qZA()),2&i&&(t.Q6J("ngIf",a.managementRegistersData),t.xp6(1),t.Q6J("ngIf",a.loading),t.xp6(3),t.Q6J("title",t.lcZ(6,14,"actionMessage.dialogCompleteReportQuestionTitle"))("content",t.lcZ(7,16,"actionMessage.dialogCompleteReportQuestionText"))("confirmButtonText",t.lcZ(8,18,"actionMessage.dialogCompleteReportQuestionYes"))("cancelButtonText",t.lcZ(9,20,"actionMessage.dialogCompleteReportQuestionNo")),t.xp6(6),t.Q6J("title",t.lcZ(12,22,"actionMessage.dialogNoHaveReportsTitle"))("content",t.lcZ(13,24,"actionMessage.dialogNoHaveReportsText"))("confirmButtonText",t.lcZ(14,26,"generalDialog.yes"))("cancelButtonText",t.lcZ(15,28,"generalDialog.no")),t.xp6(6),t.Q6J("title",t.lcZ(18,30,"actionMessage.dialogRequestForAdditionalChangesTitle"))("content",t.lcZ(19,32,"actionMessage.dialogRequestForAdditionalChangesText"))("confirmButtonText",t.lcZ(20,34,"generalDialog.yes"))("cancelButtonText",t.lcZ(21,36,"generalDialog.no")))},dependencies:[c.O5,g.JJ,g.On,_.d,y.b,l.w9,l.Z2,l.bb,l.x0,b.p,C.R,d.xm,c.uU,m.X$],styles:["tbody{background:#fff}\n"],encapsulation:2})}return n})();var Rt=s(4306),R=s(3880),At=s(8926),wt=s(7825),x=s(5255);const Ft=["dialogConfirm"],Tt=["dialogNoHaveEntry"],Zt=["dialogRequestForAdditionalChanges"],Pt=["modalNewEntrie"];function Ot(n,r){if(1&n&&(t.TgZ(0,"div")(1,"ngb-alert",17)(2,"div",18),t._uU(3),t.ALo(4,"translate"),t.ALo(5,"date"),t.qZA()()()),2&n){const e=t.oxw(2);t.xp6(1),t.Q6J("type","success")("dismissible",!1),t.xp6(2),t.AsE("",t.lcZ(4,4,"actionMessage.reportCompleted")," ",t.xi3(5,6,e.report.date_completed,"dd.MM.yyyy. HH:mm"),"")}}function St(n,r){1&n&&(t.TgZ(0,"div")(1,"ngb-alert",17)(2,"div",18),t._uU(3),t.ALo(4,"translate"),t.qZA()()()),2&n&&(t.xp6(1),t.Q6J("type","warning")("dismissible",!1),t.xp6(2),t.Oqu(t.lcZ(4,3,"actionMessage.reportCompletedNotYet")))}function kt(n,r){if(1&n&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&n){const e=r.item;t.xp6(1),t.AsE("",e.fbz," - ",e.year,"")}}function Nt(n,r){if(1&n&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&n){const e=r.item;t.xp6(1),t.AsE("",e.fbz," - ",e.year,"")}}function Dt(n,r){if(1&n&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&n){const e=r.item;t.xp6(1),t.AsE("",e.fbz," - ",e.year,"")}}function Et(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"p",19),t.NdJ("click",function(){t.CHM(e);const a=t.oxw(2);return t.KtG(a.openModalNewEntrie())}),t._UZ(1,"span",20),t._uU(2),t.ALo(3,"translate"),t.qZA()}2&n&&(t.xp6(2),t.hij(" ",t.lcZ(3,1,"commonFields.createNew")," "))}function Jt(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"button",26),t.NdJ("click",function(){t.CHM(e);const a=t.oxw(3);return t.KtG(a.completeReportsDialog())}),t._UZ(1,"span",27),t._uU(2),t.ALo(3,"translate"),t.qZA()}2&n&&(t.xp6(2),t.hij(" ",t.lcZ(3,1,"action.completeReport"),""))}function Bt(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"button",28),t.NdJ("click",function(){t.CHM(e);const a=t.oxw(3);return t.KtG(a.requestForAdditionalChanges())}),t._UZ(1,"span",29),t._uU(2),t.ALo(3,"translate"),t.qZA()}2&n&&(t.xp6(2),t.hij(" ",t.lcZ(3,1,"action.requestAdminToChangeStatus"),""))}function Qt(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"button",30),t.NdJ("click",function(){t.CHM(e);const a=t.oxw(3);return t.KtG(a.noHaveEntryDialog())}),t._UZ(1,"span",31),t._uU(2),t.ALo(3,"translate"),t.qZA()}2&n&&(t.xp6(2),t.hij(" ",t.lcZ(3,1,"action.noHaveEntry"),""))}function Gt(n,r){if(1&n&&(t.TgZ(0,"div",21)(1,"div",22),t.YNc(2,Jt,4,3,"button",23),t.YNc(3,Bt,4,3,"button",24),t.YNc(4,Qt,4,3,"button",25),t.qZA()()),2&n){const e=t.oxw(2);t.xp6(2),t.Q6J("ngIf",!e.report||e.report.status===e.reportStatusEnum.draft),t.xp6(1),t.Q6J("ngIf",e.report&&e.report.status===e.reportStatusEnum.completed),t.xp6(1),t.Q6J("ngIf",!e.report||e.report.status!==e.reportStatusEnum.completed)}}function Ht(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"app-dynamic-grid",32,33),t.NdJ("submit",function(a){t.CHM(e);const o=t.oxw(2);return t.KtG(o.submit(a))})("refreshParentComponent",function(){t.CHM(e);const a=t.oxw(2);return t.KtG(a.refreshGrid())}),t.qZA()}if(2&n){const e=t.oxw(2);t.Q6J("path",e.path)("file",e.file)("data",e.data)("disableCRUD",!(e.filter&&e.filter.water)||e.report&&e.report.status===e.reportStatusEnum.completed)("hideCreateNew",!0)}}function qt(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"div")(1,"div",6)(2,"div",7),t.YNc(3,Ot,6,9,"div",0),t.YNc(4,St,5,5,"div",0),t.qZA(),t.TgZ(5,"div",8)(6,"ng-select",9),t.NdJ("ngModelChange",function(a){t.CHM(e);const o=t.oxw();return t.KtG(o.filter.managementRegisterId=a)})("change",function(a){t.CHM(e);const o=t.oxw();return t.KtG(o.onChangeManagementRegister(a))}),t.ALo(7,"translate"),t.YNc(8,kt,2,2,"ng-template",10),t.YNc(9,Nt,2,2,"ng-template",11),t.YNc(10,Dt,2,2,"ng-template",12),t.qZA()(),t.TgZ(11,"div",8)(12,"ng-select",13),t.NdJ("ngModelChange",function(a){t.CHM(e);const o=t.oxw();return t.KtG(o.filter.water=a)})("change",function(a){t.CHM(e);const o=t.oxw();return t.KtG(o.onChangeWater(a))}),t.ALo(13,"translate"),t.YNc(14,Et,4,3,"ng-template",14),t.qZA()(),t.YNc(15,Gt,5,3,"div",15),t.qZA(),t.YNc(16,Ht,2,5,"app-dynamic-grid",16),t.qZA()}if(2&n){const e=t.oxw();t.xp6(3),t.Q6J("ngIf",e.report&&e.report.status===e.reportStatusEnum.completed),t.xp6(1),t.Q6J("ngIf",e.allData&&e.allData.length&&(!e.report||e.report.status===e.reportStatusEnum.draft)),t.xp6(2),t.Q6J("items",e.managementRegistersData)("ngModel",e.filter.managementRegisterId)("placeholder",t.lcZ(7,12,"commonFields.chooseManagementRegistry"))("searchable",!0),t.xp6(6),t.Q6J("items",e.allWaters)("ngModel",e.filter.water)("placeholder",t.lcZ(13,14,"commonFields.chooseNameOfWater"))("searchable",!0),t.xp6(3),t.Q6J("ngIf",e.filter),t.xp6(1),t.Q6J("ngIf",!e.loading)}}function Lt(n,r){1&n&&t._UZ(0,"app-loader")}function zt(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"div",34)(1,"h5",35),t._uU(2),t.ALo(3,"translate"),t.qZA(),t.TgZ(4,"button",36),t.NdJ("click",function(){const o=t.CHM(e).$implicit;return t.KtG(o.dismiss("Cross click"))}),t.TgZ(5,"span",37),t._uU(6,"\xd7"),t.qZA()()(),t.TgZ(7,"div",38)(8,"app-dynamic-forms",39,40),t.NdJ("submit",function(a){t.CHM(e);const o=t.oxw();return t.KtG(o.submitNewEntriesEmitter(a))}),t.qZA()()}if(2&n){const e=t.oxw();t.xp6(2),t.Oqu(e.title?e.title:t.lcZ(3,3,"generalDialog.areYouSure")),t.xp6(6),t.Q6J("path","forms/owner")("file","new-entrie-name-of-water.json")}}let It=(()=>{class n{constructor(e,i,a,o,w){this._service=e,this._storageService=i,this._toastr=a,this._modalService=o,this._helpService=w,this.path="grids/owner",this.file="bird-count.json",this.filter=new R.G,this.data=[],this.reportStatusEnum=x.x,this.loading=!1,this.waterCustom=new S}ngOnInit(){this.getManagementRegistersData(),this._storageService.getValueFromLocalStorage("bird-count-filter")?(this.filter=this._storageService.getValueFromLocalStorage("bird-count-filter"),this.filter.water?this.getBirdCountForSelectedWater():this.data=[]):this.filter=new R.G}getManagementRegistersData(){this._service.callGetMethod("/api/owner/getManagementRegistersData","").subscribe(e=>{this.managementRegistersData=e,e.length&&(this.filter.managementRegister?this.getWatersForSelectedManagementRegister(this.filter.managementRegister.fbz):this.data=[])})}getWatersForSelectedManagementRegister(e){this._service.callGetMethod("api/owner/getAllWaters?fbz="+e).subscribe(i=>{this.allWaters=i,1===i.length&&(this.filter.water=i[0].id,this.getBirdCountForSelectedWater()),this.getBirdCountReport()})}getBirdCountForSelectedWater(){this.initializeDefaultData(),this.loading=!0,this._service.callGetMethod("api/owner/getBirdCountForSelectedWater?fbz="+this.filter.managementRegister.fbz+"&id_water="+this.filter.water).subscribe(e=>{this.prepackedData(e),this.loading=!1})}getBirdCountReport(){this._service.callGetMethod("/api/owner/getBirdCountReport?fbz="+this.filter.managementRegister.fbz).subscribe(e=>{this.report=e?e[0]:new wt.v})}onChangeManagementRegister(e){this.loading=!0,setTimeout(()=>{this.data=[],this.loading=!1},1),this.filter.managementRegister=e,this.filter.water=null,this._storageService.setValueInLocalStorage("bird-count-filter",this.filter),this.filter.managementRegister?(this.filter.managementRegisterId=e.id,this.getWatersForSelectedManagementRegister(e.fbz),this._storageService.setValueInLocalStorage("bird-count-filter",this.filter)):(this._storageService.deleteValueFromLocalStorage("bird-count-filter"),this.filter=new R.G)}onChangeWater(){this.getBirdCountForSelectedWater(),this._storageService.setValueInLocalStorage("bird-count-filter",this.filter)}initializeDefaultData(){this.data=(new At.t).data;const e=this.filter.managementRegister.year;for(let i=0;i<this.data.length;i++)this.data[i].date=this.data[i].date.replace("#currentYear",e.toString())}prepackedData(e){for(let i=0;i<e.length;i++)for(let a=0;a<this.data.length;a++)if(this.data[a].date===e[i].date){this.data[a]=e[i];break}}submit(e){e.fbz=this.filter.managementRegister.fbz,e.year=this.filter.managementRegister.year,e.id_water=this.filter.water,this._service.callPostMethod("/api/owner/setBirdCount",e).subscribe(i=>{i&&this._toastr.showSuccess()})}refreshGrid(){this.getBirdCountForSelectedWater()}completeReportsDialog(){this.dialogConfirm.showQuestionModal()}confirmCompleteReport(){this.loading=!0,this.report={fbz:this.filter.managementRegister.fbz,year:this.filter.managementRegister.year,status:x.x.completed,date_completed:new Date},this._service.callPostMethod("/api/owner/completeBirdCountReport",this.report).subscribe(e=>{e&&(this._toastr.showSuccess(),this.refreshGrid())})}noHaveEntryDialog(){this.dialogNoHaveEntry.showQuestionModal()}confirmNoHaveEntry(){this.loading=!0,this.report={fbz:this.filter.managementRegister.fbz,year:this.filter.managementRegister.year,status:this.reportStatusEnum.completed,date_completed:new Date},this._service.callPostMethod("/api/owner/noHaveBirdCountEntry",this.report).subscribe(e=>{e&&(this.refreshGrid(),this._toastr.showSuccess())})}requestForAdditionalChanges(){this.dialogRequestForAdditionalChanges.showQuestionModal()}requestToAdminForAdditionalChanges(){this._service.callPostMethod("/api/owner/requestToAdminForAdditionalBirdCountReportChanges",this.report).subscribe(e=>{e&&this._toastr.showSuccess()})}openModalNewEntrie(){setTimeout(()=>{this.modalDialog=this._modalService.open(this.modal,{centered:!0,windowClass:"modal modal-danger"})},20)}submitNewEntriesEmitter(e){this._helpService.checkUndefinedProperty(e)&&"submit"!=e.type&&(this.waterCustom={type_of_water:e.type_of_water,name:e.name,fbz:this.filter.managementRegister.fbz},this._service.callPostMethod("/api/owner/createNewWaterNameEntry",this.waterCustom).subscribe(i=>{this.getWatersForSelectedManagementRegister(this.filter.managementRegister.fbz),this.filter.water=i,this.loading=!0,setTimeout(()=>{this.initializeDefaultData(),this.loading=!1},10),this.modalDialog.close()}))}static#t=this.\u0275fac=function(i){return new(i||n)(t.Y36(h.f),t.Y36(u.V),t.Y36(f.l),t.Y36(d.FF),t.Y36(k.s))};static#e=this.\u0275cmp=t.Xpm({type:n,selectors:[["app-bird-count"]],viewQuery:function(i,a){if(1&i&&(t.Gf(Ft,5),t.Gf(Tt,5),t.Gf(Zt,5),t.Gf(Pt,5)),2&i){let o;t.iGM(o=t.CRH())&&(a.dialogConfirm=o.first),t.iGM(o=t.CRH())&&(a.dialogNoHaveEntry=o.first),t.iGM(o=t.CRH())&&(a.dialogRequestForAdditionalChanges=o.first),t.iGM(o=t.CRH())&&(a.modal=o.first)}},decls:22,vars:38,consts:[[4,"ngIf"],["modalNewEntrie",""],[3,"title","content","confirmButtonText","cancelButtonText","confirm"],["dialogConfirm",""],["dialogNoHaveEntry",""],["dialogRequestForAdditionalChanges",""],[1,"row"],[1,"col-md-12","text-center"],[1,"mb-2","col-md-3"],["bindLabel","fbz","bindValue","id",3,"items","ngModel","placeholder","searchable","ngModelChange","change"],["ng-label-tmp",""],["ng-value-tmp",""],["ng-option-tmp",""],["bindLabel","name","bindValue","id",3,"items","ngModel","placeholder","searchable","ngModelChange","change"],["ng-footer-tmp",""],["class","col-md-6",4,"ngIf"],[3,"path","file","data","disableCRUD","hideCreateNew","submit","refreshParentComponent",4,"ngIf"],[3,"type","dismissible"],[1,"alert-body"],[1,"m-0","font-weight-bold","cursor-pointer",3,"click"],[1,"fa","fa-plus-circle"],[1,"col-md-6"],[1,"d-flex","justify-content-end","action"],["class","btn btn-success mb-1",3,"click",4,"ngIf"],["class","btn btn-primary mb-1",3,"click",4,"ngIf"],["class","btn btn-outline-danger mb-1 ml-1",3,"click",4,"ngIf"],[1,"btn","btn-success","mb-1",3,"click"],[1,"fa","fa-check"],[1,"btn","btn-primary","mb-1",3,"click"],[1,"fa","fa-question-circle-o"],[1,"btn","btn-outline-danger","mb-1","ml-1",3,"click"],[1,"fa","fa-times"],[3,"path","file","data","disableCRUD","hideCreateNew","submit","refreshParentComponent"],["grid",""],[1,"modal-header"],["id","myModalLabel160",1,"modal-title"],["type","button","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],["tabindex","0","ngbAutofocus","",1,"modal-body"],[3,"path","file","submit"],["form","dynamicForm"]],template:function(i,a){1&i&&(t.YNc(0,qt,17,16,"div",0),t.YNc(1,Lt,1,0,"app-loader",0),t.YNc(2,zt,10,5,"ng-template",null,1,t.W1O),t.TgZ(4,"app-dialog-confirm",2,3),t.NdJ("confirm",function(){return a.confirmCompleteReport()}),t.ALo(6,"translate"),t.ALo(7,"translate"),t.ALo(8,"translate"),t.ALo(9,"translate"),t.qZA(),t.TgZ(10,"app-dialog-confirm",2,4),t.NdJ("confirm",function(){return a.confirmNoHaveEntry()}),t.ALo(12,"translate"),t.ALo(13,"translate"),t.ALo(14,"translate"),t.ALo(15,"translate"),t.qZA(),t.TgZ(16,"app-dialog-confirm",2,5),t.NdJ("confirm",function(){return a.requestToAdminForAdditionalChanges()}),t.ALo(18,"translate"),t.ALo(19,"translate"),t.ALo(20,"translate"),t.ALo(21,"translate"),t.qZA()),2&i&&(t.Q6J("ngIf",a.managementRegistersData),t.xp6(1),t.Q6J("ngIf",a.loading),t.xp6(3),t.Q6J("title",t.lcZ(6,14,"actionMessage.dialogCompleteReportQuestionTitle"))("content",t.lcZ(7,16,"actionMessage.dialogCompleteReportQuestionText"))("confirmButtonText",t.lcZ(8,18,"actionMessage.dialogCompleteReportQuestionYes"))("cancelButtonText",t.lcZ(9,20,"actionMessage.dialogCompleteReportQuestionNo")),t.xp6(6),t.Q6J("title",t.lcZ(12,22,"actionMessage.dialogNoHaveReportsTitle"))("content",t.lcZ(13,24,"actionMessage.dialogNoHaveReportsText"))("confirmButtonText",t.lcZ(14,26,"generalDialog.yes"))("cancelButtonText",t.lcZ(15,28,"generalDialog.no")),t.xp6(6),t.Q6J("title",t.lcZ(18,30,"actionMessage.dialogRequestForAdditionalChangesTitle"))("content",t.lcZ(19,32,"actionMessage.dialogRequestForAdditionalChangesText"))("confirmButtonText",t.lcZ(20,34,"generalDialog.yes"))("cancelButtonText",t.lcZ(21,36,"generalDialog.no")))},dependencies:[c.O5,g.JJ,g.On,_.d,y.b,l.w9,l.Z2,l.bb,l.x0,b.p,C.R,d.xm,c.uU,m.X$]})}return n})();var Yt=s(8213);class A{}var Ut=s(6858),Kt=s(2684),Wt=s(7350);const Vt=["grid"],jt=["dialogConfirm"],Xt=["dialogNoHaveEntry"],$t=["dialogRequestForAdditionalChanges"],te=["modalNewEntrie"];function ee(n,r){if(1&n&&(t.TgZ(0,"div")(1,"ngb-alert",16)(2,"div",17),t._uU(3),t.ALo(4,"translate"),t.ALo(5,"date"),t.qZA()()()),2&n){const e=t.oxw(2);t.xp6(1),t.Q6J("type","success")("dismissible",!1),t.xp6(2),t.AsE("",t.lcZ(4,4,"actionMessage.reportCompleted")," ",t.xi3(5,6,e.report.date_completed,"dd.MM.yyyy. HH:mm"),"")}}function ne(n,r){1&n&&(t.TgZ(0,"div")(1,"ngb-alert",16)(2,"div",17),t._uU(3),t.ALo(4,"translate"),t.qZA()()()),2&n&&(t.xp6(1),t.Q6J("type","warning")("dismissible",!1),t.xp6(2),t.Oqu(t.lcZ(4,3,"actionMessage.reportCompletedNotYet")))}function ae(n,r){if(1&n&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&n){const e=r.item;t.xp6(1),t.AsE("",e.fbz," - ",e.year,"")}}function ie(n,r){if(1&n&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&n){const e=r.item;t.xp6(1),t.AsE("",e.fbz," - ",e.year,"")}}function oe(n,r){if(1&n&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&n){const e=r.item;t.xp6(1),t.AsE("",e.fbz," - ",e.year,"")}}function re(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"button",23),t.NdJ("click",function(){t.CHM(e);const a=t.oxw(3);return t.KtG(a.completeReportsDialog())}),t._UZ(1,"span",24),t._uU(2),t.ALo(3,"translate"),t.qZA()}2&n&&(t.xp6(2),t.hij(" ",t.lcZ(3,1,"action.completeReport"),""))}function se(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"button",25),t.NdJ("click",function(){t.CHM(e);const a=t.oxw(3);return t.KtG(a.requestForAdditionalChanges())}),t._UZ(1,"span",26),t._uU(2),t.ALo(3,"translate"),t.qZA()}2&n&&(t.xp6(2),t.hij(" ",t.lcZ(3,1,"action.requestAdminToChangeStatus"),""))}function le(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"button",27),t.NdJ("click",function(){t.CHM(e);const a=t.oxw(3);return t.KtG(a.noHaveEntryDialog())}),t._UZ(1,"span",28),t._uU(2),t.ALo(3,"translate"),t.qZA()}2&n&&(t.xp6(2),t.hij(" ",t.lcZ(3,1,"action.noHaveEntry"),""))}function ce(n,r){if(1&n&&(t.TgZ(0,"div",18)(1,"div",19),t.YNc(2,re,4,3,"button",20),t.YNc(3,se,4,3,"button",21),t.YNc(4,le,4,3,"button",22),t.qZA()()),2&n){const e=t.oxw(2);t.xp6(2),t.Q6J("ngIf",!e.report||e.report.status===e.reportStatusEnum.draft),t.xp6(1),t.Q6J("ngIf",e.report&&e.report.status===e.reportStatusEnum.completed),t.xp6(1),t.Q6J("ngIf",!e.report||e.report.status!==e.reportStatusEnum.completed)}}function ge(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"app-dynamic-grid",29,30),t.NdJ("emitValueForCustomForm",function(a){t.CHM(e);const o=t.oxw(2);return t.KtG(o.emitValueForCustomForm(a))})("refreshParentComponent",function(){t.CHM(e);const a=t.oxw(2);return t.KtG(a.refreshGrid())}),t.qZA()}if(2&n){const e=t.oxw(2),i=t.MAs(5);t.Q6J("path",e.path)("file",e.file)("data",e.data)("disableCRUD",e.report&&e.report.status===e.reportStatusEnum.completed)("template",i)("modalDialogSize","modal-dialog-large")}}function de(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"div")(1,"div",7)(2,"div",8),t.YNc(3,ee,6,9,"div",0),t.YNc(4,ne,5,5,"div",0),t.qZA(),t.TgZ(5,"div",9)(6,"ng-select",10),t.NdJ("ngModelChange",function(a){t.CHM(e);const o=t.oxw();return t.KtG(o.filter.managementRegisterId=a)})("change",function(a){t.CHM(e);const o=t.oxw();return t.KtG(o.onChangeManagementRegister(a))}),t.ALo(7,"translate"),t.YNc(8,ae,2,2,"ng-template",11),t.YNc(9,ie,2,2,"ng-template",12),t.YNc(10,oe,2,2,"ng-template",13),t.qZA()(),t.YNc(11,ce,5,3,"div",14),t.qZA(),t.YNc(12,ge,2,6,"app-dynamic-grid",15),t.qZA()}if(2&n){const e=t.oxw();t.xp6(3),t.Q6J("ngIf",e.report&&e.report.status===e.reportStatusEnum.completed),t.xp6(1),t.Q6J("ngIf",e.data&&e.data.length&&(!e.report||e.report.status===e.reportStatusEnum.draft)),t.xp6(2),t.Q6J("items",e.managementRegistersData)("ngModel",e.filter.managementRegisterId)("placeholder",t.lcZ(7,8,"commonFields.chooseManagementRegistry"))("searchable",!0),t.xp6(5),t.Q6J("ngIf",e.filter.managementRegister),t.xp6(1),t.Q6J("ngIf",!e.loading)}}function me(n,r){1&n&&t._UZ(0,"app-loader")}function _e(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"div",31)(1,"h5",32),t._uU(2),t.ALo(3,"translate"),t.qZA(),t.TgZ(4,"button",33),t.NdJ("click",function(){const o=t.CHM(e).$implicit;return t.KtG(o.dismiss("Cross click"))}),t.TgZ(5,"span",34),t._uU(6,"\xd7"),t.qZA()()(),t.TgZ(7,"div",35)(8,"app-dynamic-forms",36,37),t.NdJ("submit",function(a){t.CHM(e);const o=t.oxw();return t.KtG(o.submitNewEntriesEmitter(a))}),t.qZA()()}if(2&n){const e=t.oxw();t.xp6(2),t.Oqu(e.title?e.title:t.lcZ(3,3,"generalDialog.areYouSure")),t.xp6(6),t.Q6J("path","forms/owner")("file","new-entrie-name-of-water.json")}}function pe(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"app-custom-form-bird-damage",39),t.NdJ("submit",function(a){t.CHM(e);const o=t.oxw(2);return t.KtG(o.handleSubmit(a))}),t.qZA()}if(2&n){const e=t.oxw(2);t.Q6J("data",e.itemData)}}function he(n,r){if(1&n&&t.YNc(0,pe,1,1,"app-custom-form-bird-damage",38),2&n){const e=t.oxw();t.Q6J("ngIf",e.itemData)}}let fe=(()=>{class n{constructor(e,i,a,o){this._service=e,this._storageService=i,this._toastr=a,this._messageService=o,this.path="grids/owner",this.file="bird-damage.json",this.filter=new A,this.data=[],this.reportStatusEnum=x.x,this.loading=!1}ngOnInit(){this.getManagementRegistersData(),this.filter=this._storageService.getValueFromLocalStorage("bird-damage-filter")?this._storageService.getValueFromLocalStorage("bird-damage-filter"):new A,this.getDataForGrid(),this.getReport()}getManagementRegistersData(){this._service.callGetMethod("/api/owner/getManagementRegistersData","").subscribe(e=>{this.managementRegistersData=e})}getDataForGrid(){this.loading=!0,this._service.callGetMethod("api/owner/getBirdDamage?fbz="+(this.filter.managementRegister&&this.filter.managementRegister.fbz)).subscribe(e=>{this.data=e,this.loading=!1})}getReport(){this._service.callGetMethod("/api/owner/getBirdDamageReport?fbz="+this.filter.managementRegister.fbz).subscribe(e=>{this.report=e?e[0]:new Ut.O})}onChangeManagementRegister(e){this.filter.managementRegister=e,this._storageService.setValueInLocalStorage("bird-damage-filter",this.filter),this.filter.managementRegister?this._storageService.setValueInLocalStorage("bird-damage-filter",this.filter):(this._storageService.deleteValueFromLocalStorage("bird-damage-filter"),this.filter=new A),this.getDataForGrid(),this.getReport()}emitValueForCustomForm(e){this.itemData=e||new Yt.Su,this.itemData.fbz=this.filter.managementRegister.fbz,this.itemData.year=this.filter.managementRegister.year}refreshGrid(){this.getDataForGrid()}completeReportsDialog(){this.dialogConfirm.showQuestionModal()}confirmCompleteReport(){this.loading=!0,this.report={fbz:this.filter.managementRegister.fbz,year:this.filter.managementRegister.year,status:x.x.completed,date_completed:new Date},this._service.callPostMethod("/api/owner/completeBirdDamageReport",this.report).subscribe(e=>{e&&(this._toastr.showSuccess(),this.refreshGrid())})}noHaveEntryDialog(){this.dialogNoHaveEntry.showQuestionModal()}confirmNoHaveEntry(){this.loading=!0,this.report={fbz:this.filter.managementRegister.fbz,year:this.filter.managementRegister.year,status:this.reportStatusEnum.completed,date_completed:new Date},this._service.callPostMethod("/api/owner/noHaveBirdDamageEntry",this.report).subscribe(e=>{e&&(this.refreshGrid(),this._toastr.showSuccess())})}requestForAdditionalChanges(){this.dialogRequestForAdditionalChanges.showQuestionModal()}requestToAdminForAdditionalChanges(){this._service.callPostMethod("/api/owner/requestToAdminForAdditionalBirdCountReportChanges",this.report).subscribe(e=>{e&&this._toastr.showSuccess()})}handleSubmit(e){this.grid.closeEditForm(),this.getDataForGrid()}static#t=this.\u0275fac=function(i){return new(i||n)(t.Y36(h.f),t.Y36(u.V),t.Y36(f.l),t.Y36(Kt.e))};static#e=this.\u0275cmp=t.Xpm({type:n,selectors:[["app-bird-damage"]],viewQuery:function(i,a){if(1&i&&(t.Gf(Vt,5),t.Gf(jt,5),t.Gf(Xt,5),t.Gf($t,5),t.Gf(te,5)),2&i){let o;t.iGM(o=t.CRH())&&(a.grid=o.first),t.iGM(o=t.CRH())&&(a.dialogConfirm=o.first),t.iGM(o=t.CRH())&&(a.dialogNoHaveEntry=o.first),t.iGM(o=t.CRH())&&(a.dialogRequestForAdditionalChanges=o.first),t.iGM(o=t.CRH())&&(a.modal=o.first)}},decls:24,vars:38,consts:[[4,"ngIf"],["modalNewEntrie",""],["customFormBirdDamage",""],[3,"title","content","confirmButtonText","cancelButtonText","confirm"],["dialogConfirm",""],["dialogNoHaveEntry",""],["dialogRequestForAdditionalChanges",""],[1,"row"],[1,"col-md-12","text-center"],[1,"mb-2","col-md-3"],["bindLabel","fbz","bindValue","id",3,"items","ngModel","placeholder","searchable","ngModelChange","change"],["ng-label-tmp",""],["ng-value-tmp",""],["ng-option-tmp",""],["class","col-md-9",4,"ngIf"],[3,"path","file","data","disableCRUD","template","modalDialogSize","emitValueForCustomForm","refreshParentComponent",4,"ngIf"],[3,"type","dismissible"],[1,"alert-body"],[1,"col-md-9"],[1,"d-flex","justify-content-end","action"],["class","btn btn-success mb-1",3,"click",4,"ngIf"],["class","btn btn-primary mb-1",3,"click",4,"ngIf"],["class","btn btn-outline-danger mb-1 ml-1",3,"click",4,"ngIf"],[1,"btn","btn-success","mb-1",3,"click"],[1,"fa","fa-check"],[1,"btn","btn-primary","mb-1",3,"click"],[1,"fa","fa-question-circle-o"],[1,"btn","btn-outline-danger","mb-1","ml-1",3,"click"],[1,"fa","fa-times"],[3,"path","file","data","disableCRUD","template","modalDialogSize","emitValueForCustomForm","refreshParentComponent"],["grid",""],[1,"modal-header"],["id","myModalLabel160",1,"modal-title"],["type","button","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],["tabindex","0","ngbAutofocus","",1,"modal-body"],[3,"path","file","submit"],["form","dynamicForm"],[3,"data","submit",4,"ngIf"],[3,"data","submit"]],template:function(i,a){1&i&&(t.YNc(0,de,13,10,"div",0),t.YNc(1,me,1,0,"app-loader",0),t.YNc(2,_e,10,5,"ng-template",null,1,t.W1O),t.YNc(4,he,1,1,"ng-template",null,2,t.W1O),t.TgZ(6,"app-dialog-confirm",3,4),t.NdJ("confirm",function(){return a.confirmCompleteReport()}),t.ALo(8,"translate"),t.ALo(9,"translate"),t.ALo(10,"translate"),t.ALo(11,"translate"),t.qZA(),t.TgZ(12,"app-dialog-confirm",3,5),t.NdJ("confirm",function(){return a.confirmNoHaveEntry()}),t.ALo(14,"translate"),t.ALo(15,"translate"),t.ALo(16,"translate"),t.ALo(17,"translate"),t.qZA(),t.TgZ(18,"app-dialog-confirm",3,6),t.NdJ("confirm",function(){return a.requestToAdminForAdditionalChanges()}),t.ALo(20,"translate"),t.ALo(21,"translate"),t.ALo(22,"translate"),t.ALo(23,"translate"),t.qZA()),2&i&&(t.Q6J("ngIf",a.managementRegistersData),t.xp6(1),t.Q6J("ngIf",a.loading),t.xp6(5),t.Q6J("title",t.lcZ(8,14,"actionMessage.dialogCompleteReportQuestionTitle"))("content",t.lcZ(9,16,"actionMessage.dialogCompleteReportQuestionText"))("confirmButtonText",t.lcZ(10,18,"actionMessage.dialogCompleteReportQuestionYes"))("cancelButtonText",t.lcZ(11,20,"actionMessage.dialogCompleteReportQuestionNo")),t.xp6(6),t.Q6J("title",t.lcZ(14,22,"actionMessage.dialogNoHaveReportsTitle"))("content",t.lcZ(15,24,"actionMessage.dialogNoHaveReportsText"))("confirmButtonText",t.lcZ(16,26,"generalDialog.yes"))("cancelButtonText",t.lcZ(17,28,"generalDialog.no")),t.xp6(6),t.Q6J("title",t.lcZ(20,30,"actionMessage.dialogRequestForAdditionalChangesTitle"))("content",t.lcZ(21,32,"actionMessage.dialogRequestForAdditionalChangesText"))("confirmButtonText",t.lcZ(22,34,"generalDialog.yes"))("cancelButtonText",t.lcZ(23,36,"generalDialog.no")))},dependencies:[c.O5,g.JJ,g.On,_.d,y.b,l.w9,l.Z2,l.bb,b.p,C.R,d.xm,Wt._,c.uU,m.X$]})}return n})();var ue=s(607);const be=[{path:"fish-stocking",component:nt,canDeactivate:[Z.T]},{path:"observation-sheet",component:E,canDeactivate:[Z.T]},{path:"fish-catch",component:yt},{path:"bird-count",component:It},{path:"bird-damage",component:fe}];let Ce=(()=>{class n{static#t=this.\u0275fac=function(i){return new(i||n)};static#e=this.\u0275mod=t.oAB({type:n});static#n=this.\u0275inj=t.cJS({imports:[c.ez,g.u5,T.Bz.forChild(be),N.w,l.A0,at.$,m.aw,d._A,Rt.xD,ue.I,T.Bz]})}return n})()}}]);