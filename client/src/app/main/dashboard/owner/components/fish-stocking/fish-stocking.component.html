<div *ngIf="managementRegistersData">
    <div class="row">
        <div class="mb-2 col-lg-3 col-md-12">
            <ng-select [items]="managementRegistersData" bindLabel="fbz" bindValue="id"
                [(ngModel)]="selectedManagementRegistryId"
                [placeholder]="'commonFields.chooseManagementRegistry' | translate" (change)="onChange($event)"
                [searchable]="true">
                <ng-template ng-label-tmp let-item="item" let-clear="clear">
                    <span>{{item.fbz}} - {{item.year}}</span>
                </ng-template>
                <ng-template ng-value-tmp let-item="item">
                    <span>{{item.fbz}} - {{item.year}}</span>
                </ng-template>
                <ng-template ng-option-tmp let-item="item">
                    <span>{{item.fbz}} - {{item.year}}</span>
                </ng-template>
            </ng-select>
        </div>
        <div class="col-lg-9" *ngIf="selectedManagementRegistryId">
            <div class="row">
                <div class="col-lg-9 col-md-8 text-center">
                    <div *ngIf="fishStockingReport && fishStockingReport.status === fishStockingReportEnum.completed">
                        <ngb-alert [type]="'success'" [dismissible]="false">
                            <div class="alert-body">{{'actionMessage.reportCompleted' | translate}}
                                {{fishStockingReport.date_completed | date: 'dd.MM.yyyy. HH:mm'}}</div>
                        </ngb-alert>
                    </div>
                    <div *ngIf="data && data.length && (!fishStockingReport || fishStockingReport.status ===
                        fishStockingReportEnum.draft)">
                        <ngb-alert [type]="'warning'" [dismissible]="false">
                            <div class="alert-body">{{'actionMessage.reportCompletedNotYet' | translate}}</div>
                        </ngb-alert>
                    </div>
                </div>
                <div class="col-lg-3 col-md-4 text-right">
                    <button
                        *ngIf="data && data.length && (!fishStockingReport || fishStockingReport.status === fishStockingReportEnum.draft)"
                        class="btn btn-success full-width" (click)="completeReports()"><span class="fa fa-check"></span>
                        {{'action.completeReport' |
                        translate}}</button>
                    <button *ngIf="fishStockingReport && fishStockingReport.status === fishStockingReportEnum.completed"
                        class="btn btn-danger full-width" (click)="requestForAdditionalChanges()"><span
                            class="fa fa-question-circle-o"></span>
                        {{'action.requestAdminToChangeStatus' |
                        translate}}</button>
                </div>
            </div>
        </div>
    </div>
    <div *ngIf="selectedManagementRegistry">
        <app-dynamic-grid #grid *ngIf="!loading" [path]="path" [file]="file" [data]="data"
            [additionalData]="selectedRegistry" (submit)="submit($event)" (refreshParentComponent)="refreshGrid()"
            [disableCRUD]="fishStockingReport && fishStockingReport.status === fishStockingReportEnum.completed"></app-dynamic-grid>
    </div>
    <app-no-data
        *ngIf="!managementRegistersData || !managementRegistersData.length || !selectedManagementRegistry"></app-no-data>
</div>

<app-loader *ngIf="loading"></app-loader>

<app-dialog-confirm #dialogConfirm [title]="('actionMessage.dialogCompleteReportQuestionTitle' | translate)"
    [content]="('actionMessage.dialogCompleteReportQuestionText' | translate)"
    [confirmButtonText]="('actionMessage.dialogCompleteReportQuestionYes' | translate)"
    [cancelButtonText]="('actionMessage.dialogCompleteReportQuestionNo' | translate)"
    (confirm)="confirmCompleteReport()"></app-dialog-confirm>

<app-dialog-confirm #dialogRequestForAdditionalChanges
    [title]="('actionMessage.dialogRequestForAdditionalChangesTitle' | translate)"
    [content]="('actionMessage.dialogRequestForAdditionalChangesText' | translate)"
    [confirmButtonText]="('generalDialog.yes' | translate)" [cancelButtonText]="('generalDialog.no' | translate)"
    (confirm)="requestToAdminForAdditionalChanges()"></app-dialog-confirm>